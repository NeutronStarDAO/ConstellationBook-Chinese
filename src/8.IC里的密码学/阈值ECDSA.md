https://medium.com/dfinity/threshold-ecdsa-the-key-ingredient-behind-the-internet-computers-bitcoin-and-ethereum-cf22649b98a1

https://internetcomputer.org/bitcoin-integration

https://www.youtube.com/watch?v=TtVo3krjARI

https://wiki.internetcomputer.org/wiki/Chain-key_Bitcoin

https://wiki.internetcomputer.org/wiki/Know-Your-Transaction_(KYT)_Canister

https://forum.dfinity.org/t/threshold-ecdsa-signatures/6152

https://forum.dfinity.org/t/direct-integration-with-bitcoin/6147

https://www.youtube.com/watch?v=MulbKPwv6_s

https://internetcomputer.org/how-it-works/bitcoin-integration/

https://forum.dfinity.org/t/long-term-r-d-integration-with-the-ethereum-network/9382

https://internetcomputer.org/docs/current/developer-docs/integrations/bitcoin/bitcoin-how-it-works/#chain-key-ecdsa-signatures-a-novel-threshold-ecdsa-protocol-suite

https://medium.com/dfinity/internet-computer-ethereum-integration-explained-6967456e35f9

https://mmapped.blog/posts/19-eventlog.html

https://www.youtube.com/watch?v=UIopwQ7pBa4

https://en.wikipedia.org/wiki/Victor_Shoup

https://forum.dfinity.org/t/tecdsa-subnet-id-and-takeover-threshold/18336

IC 待研究文件夹里的 DFINITY-tECDSA 论文







ECDSA签名方案[NIST13]是一种标准且广泛使用的签名方案。近年来，主要受区块链应用的推动，出现了大量关于ECDSA签名的分布式协议研究[AHS20]。这些协议主要提供了分布式ECDSA签名服务，其目标是消除单一的漏洞点。由于ECDSA签名方案在区块链应用和其他领域中发挥的重要作用，尽管基于ECDSA设计实际的分布式签名服务要容易得多，但这仍然是一个重要的目标，特别是在设计基于其他签名方案的实际分布式签名服务时，尤其是BLS方案[BLS01，Bol03]。

在本文中，我们提出并分析了一个新的协议，提供了分布式ECDSA签名服务，具有以下特性：
1. 它假设异步通信模型，没有关于传递消息所需时间的先验限制。
2. 它假设有n个参与方组成的网络，最多有f < n/3个拜占庭故障。
3. 它假设有一个公钥基础设施，每个参与方生成自己的公钥/私钥对，知道所有其他参与方的公钥，以及一个公共参考字符串（其中包括一个离散对数未知的群元素）和一个用于模拟加密哈希函数的随机预言。
4. 它利用了一个共识子协议以及一个随机信标。
5. 它保证了安全性，意味着对手只能获得诚实方请求的签名。
6. 它提供了有保证的输出交付，意味着所有签名请求都将被满足，并且生成的签名将被交付给诚实方（在所有诚实方之间的消息最终被交付，并且共识子协议提供了活性的情况下）。
7. 它提供了非常高效的非交互式在线签名阶段，意味着在适当的消息独立预计算的前提下，对于签名请求，每个参与方只需广播一个“签名份额”，并收集足够多的这种“签名份额”来计算签名；特别是在线签名阶段不需要（更昂贵的）共识子协议。
8. 它支持BIP32风格的可加密密钥衍生[Wui20]，这意味着可以轻松地从单个签名密钥按层次方式派生出许多签名密钥。

我们的协议正在被实施并集成到互联网计算机的架构中[DFI22]。互联网计算机本质上是一组通信的复制状态机，其中每个状态机都是通过运行基于区块链的共识协议的节点网络来实现的[CDH+21]。我们新的分布式ECDSA签名协议的共识子协议是直接使用互联网计算机的基于区块链的共识协议实现的。



随机信标是一种用于获取公共随机值的机制，这些值在协议确定的时间之前保持不可预测。互联网计算机架构已经实现了这样的机制，我们的签名协议的实现就是利用了这一机制。

我们在UC框架[Can00]中分析了我们协议的安全性，显示它等同于生成ECDSA签名的理想功能。这个安全性证明依赖了与椭圆曲线的离散对数问题相关的相当标准的密码学假设，并将某些哈希函数建模为随机预言（不依赖于任何与因式分解相关的假设）。因此，我们分布式签名服务的不可伪造性属性可以归结为在伴随论文[GS21]中详细分析的特定攻击模型下ECDSA签名的不可伪造性属性。

事实上，我们的新协议是一个(f + 1)-out-of-n门限签名方案。然而，将其看作一个分布式签名服务激发了在互联网计算机中使用的最基本的设计要求，即在具有拜占庭故障的异步通信模型中提供安全性和有保证的输出交付。在这些设计要求下，不可避免地会有f < n/3的拜占庭故障数限制，因此，高于f +1的重构门限并不特别有用。

为互联网计算机配备门限ECDSA签名服务具有多个应用。例如，使用这样的服务，运行在互联网计算机上的智能合约将能够安全地持有和使用比特币和其他加密货币。虽然我们的协议是为在互联网计算机上运行而设计的，但在其他分布式计算环境中也应该能够很好地运行。

虽然我们的协议在异步通信网络上提供了有保证的输出交付，但[AHS20]中描述的最近的门限ECDSA签名协议都没有享受这一特性。此外，从渐近通信和计算复杂性的角度来看，我们协议的性能满足或超过了这些协议中的任何一个。



在设计我们的新门限签名方案时，我们开发了一些可能具有独立兴趣的新密码学方案：

• 一种新的异步可验证秘密分享（AVSS）方案，简单且高效；

• 一种新的多接收方加密方案，简单且高效。



## 1.1 关于通信模型和共识更多内容

在设计和分析任何分布式协议时，必须指定一个通信模型，该模型描述了对手延迟消息传递的能力。在光谱的两端，我们有以下模型：

• 在同步模型中，存在某个已知的有限时间界限δ，使得对于任何发送的消息，它将在不到时间δ内被传递。

• 在异步模型中，对于任何发送的消息，对手都可以延迟其传递的时间，以便没有关于传递消息所需时间的界限。

为了获得高度分散和安全的协议，我们主要关注的是节点分布在全球的网络，对于这种网络，同步通信模型将非常不现实。实际上，攻击者可以通过延迟诚实节点或它们之间的通信来破坏协议的正确行为。这种攻击通常比获得对诚实节点的控制和腐败更容易。

共识是许多分布式协议的核心问题。事实上，任何分布式签名协议都必须包含一个分布式密钥生成协议作为子协议，这本身是共识的一种特殊情况，因为所有参与方至少必须生成并就签名方案的公钥达成一致。

共识问题有不同的表述方式，而我们新的分布式签名协议所需的是一种称为“对一个共同子集”的协议（ACS）。在ACS协议中，每个参与方向协议提供一个输入，并作为输出获得一组输入的子集。重要的是，所有诚实的参与方必须获得相同的子集。子集的大小由协议的大小参数k确定，其中k ≤ n − f。只要所有参与方参与协议，它们之间的所有消息最终都会被传递，所有诚实的参与方应最终获得此子集。还可以强加外部有效性条件，协议确保每个输入都满足这个条件。

ACS问题首次在[BKR94]中定义和研究。虽然这项工作提供了一个理论上的概念证明，但得到的协议并不实际。最近的研究工作[MXC+16, DRZ18, GLT+20]在实现更实际的ACS协议方面取得了巨大进展。不幸的是，尽管这些协议具有相当高的吞吐量，但它们仍然没有提供非常好的延迟性能。

在将我们的新分布式签名协议集成到互联网计算机中时，我们使用了已经在互联网计算机中实现的共识协议来实现ACS。与大多数不依赖于同步通信的实际拜占庭容错共识协议（例如[CL99，BKM18，YMR+18]）一样，互联网计算机的共识协议[CDH+21]依赖于部分同步通信模型[DLS88]。这种部分同步模型可以以各种方式进行表述。互联网计算机使用的部分同步假设大致上说，通信在短时间间隔内会周期性地同步；而且，消息传递的同步边界δ无需提前知道。

这种部分同步假设只需要确保共识协议取得进展（所谓的“活性”属性）。它不需要确保共识的正确行为（所谓的“安全”属性），也不需要在互联网计算机协议栈的任何其他地方使用。在部分同步和拜占庭故障的假设下，已知在故障数量上的f < n/3界限是最优的。

尽管我们的ECDSA签名协议在我们特定的共识实现中间接依赖于部分同步假设，但我们认为最好的做法是在共识之外不依赖于这种假设，有几个原因。首先，构建一个依赖于部分同步但在这种假设开始失败时（可能是间歇性地）仍然能够优雅降级的共识协议是一项具有挑战性的工程任务，最好将这个问题隔离在共识层面。其次，由于纯粹的异步共识协议不断改进，尤其是因为共识只在预计算阶段需要，而不在签名阶段需要低延迟，因此使用这种协议可能变得实际可行。



